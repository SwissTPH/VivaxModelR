<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VivaxModelR • VivaxModelR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="VivaxModelR">
<meta property="og:description" content="VivaxModelR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">VivaxModelR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vivaxmodelr.html">VivaxModelR</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="vivaxmodelr_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>VivaxModelR</h1>
                        <h4 class="author">Clara Champagne, Maximilian Gerhards, Emilie Pothin</h4>
            
      
      
      <div class="hidden name"><code>vivaxmodelr.Rmd</code></div>

    </div>

    
    
<p>This package contains functions to simulate a compartmental model for Plasmodium Vivax and calculate the associated reproduction number for a given epidemiological setting, based on data on reported local and imported cases. The model includes case management and vector control.</p>
It is based on <span class="citation">White et al. (2016)</span>, and can be represented by the following diagram:
<div class="figure">
<img src="models_cartoon.png" alt="Schematic representation of the model" width="80%"><p class="caption">
Schematic representation of the model
</p>
</div>
<p>where <span class="math inline">\(I_L\)</span> is the proportion of individuals with both blood and liver stage parasites, <span class="math inline">\(I_0\)</span> is the proportion of individuals with blood stage parasites only, <span class="math inline">\(S_L\)</span> is the proportion of individuals with liver stage parasites only, and <span class="math inline">\(S_0\)</span> is the proportion of susceptible individuals.</p>
<p>As in <span class="citation">White et al. (2016)</span>, it requires 4 biological parameters: <span class="math inline">\(\lambda\)</span> (transmission rate, called “lambda” in the package), <span class="math inline">\(r\)</span> (blood parasites clearance rate), <span class="math inline">\(\gamma_L\)</span> (liver parasites clearance rate, called “gamma”) and <span class="math inline">\(f\)</span> (relapse frequency). Values from the literature can be found for <span class="math inline">\(r\)</span>, <span class="math inline">\(\gamma_L\)</span> and <span class="math inline">\(f\)</span>. The parameter <span class="math inline">\(\lambda\)</span> is highly setting specific and can be calculated based on incidence and importation data using the functions from this package. This also provides estimates of setting specific reproduction numbers: <span class="math inline">\(R_0\)</span> (in the absence of control intervention) and <span class="math inline">\(R_c\)</span> (considering current control interventions).</p>
<p>For more information, please refer to the associated paper.</p>
<div id="how-to-use-the-package" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-use-the-package" class="anchor"></a>How to use the package</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">VivaxModelR</span><span class="op">)</span></code></pre></div>
<div id="calculate-the-reproduction-numbers-from-data-on-reported-cases" class="section level3">
<h3 class="hasAnchor">
<a href="#calculate-the-reproduction-numbers-from-data-on-reported-cases" class="anchor"></a>Calculate the reproduction numbers from data on reported cases</h3>
<p>Creating a dummy dataset with reported incidence and the proportion of imported cases (the user should include their real data). Incidence is in cases per 1000 person-year. Each line corresponds to an administrative area or a year of data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mydata</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"regionA"</span>,<span class="st">"regionB"</span><span class="op">)</span>,incidence<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">23</span>,<span class="fl">112</span><span class="op">)</span>,prop_import<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Convert incidence to cases per person day:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mydata</span><span class="op">$</span><span class="va">h</span><span class="op">=</span><span class="fu"><a href="../reference/incidence_year2day.html">incidence_year2day</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">incidence</span><span class="op">)</span></code></pre></div>
<p>Indicate model intervention parameter values for current case management (<span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>) and vector control (<span class="math inline">\(\omega\)</span>), as well as the observation rate (<span class="math inline">\(\rho\)</span>).</p>
<p>The parameter <span class="math inline">\(\alpha\)</span> (called “alpha” in the package) represents the probability to receive effective cure for the blood stage infection and the parameter <span class="math inline">\(\beta\)</span> (called “beta”) represents the probability that individuals clear their liver stage infection when receiving their treatment. The parameter <span class="math inline">\(\omega\)</span> (called “omega”) quantifies the intensity of vector control (0 indicating perfect vector control and 1 indicating the absence of vector control). The observation rate <span class="math inline">\(\rho\)</span> (called “rho”) indicates the proportion of all infections that are effectively observed and reported in the incidence data. The parameter <span class="math inline">\(\alpha\)</span> should reflect the proportion of individual effectively cured (for example because they present symptoms, seek care, and receive and adhere to an effective treatment, as in <span class="citation">Galactionova et al. (2015)</span> for example).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mydata</span><span class="op">$</span><span class="va">alpha</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.17</span>, <span class="fl">0.12</span><span class="op">)</span> <span class="co"># proportion of treated cases</span>
<span class="va">mydata</span><span class="op">$</span><span class="va">beta</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.43</span>,<span class="fl">0.42</span><span class="op">)</span> <span class="co"># proportion of radical cure</span>
<span class="va">mydata</span><span class="op">$</span><span class="va">rho</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.18</span>, <span class="fl">0.13</span><span class="op">)</span> <span class="co"># reporting rate (here, we assume that all treated cases are reported)</span>
<span class="va">mydata</span><span class="op">$</span><span class="va">omega</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>  <span class="co"># no vector control</span></code></pre></div>
<p>Run the model and save the results in a new database.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mydata_withR0RC</span><span class="op">=</span><span class="fu"><a href="../reference/calculate_r0_rc_fromdata.html">calculate_r0_rc_fromdata</a></span><span class="op">(</span>df<span class="op">=</span><span class="va">mydata</span>, f<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">72</span>, gamma<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">223</span>, r<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">60</span>, return.all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span></code></pre></div>
<p>Visualise the output: several additional columns were created, including <span class="math inline">\(R_0\)</span> and <span class="math inline">\(R_c\)</span> for each region/year.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mydata_withR0RC</span>
<span class="co">#&gt;        id incidence prop_import            h alpha beta  rho omega      lambda</span>
<span class="co">#&gt; 1 regionA        23         0.0 0.0000630137  0.17 0.43 0.18     1 0.008913383</span>
<span class="co">#&gt; 2 regionB       112         0.1 0.0003068493  0.12 0.42 0.13     1 0.007613010</span>
<span class="co">#&gt;          Rc       R0       delta          I</span>
<span class="co">#&gt; 1 1.0266852 1.322669 0.000000000 0.01743379</span>
<span class="co">#&gt; 2 0.9498208 1.129705 0.000269643 0.12462803</span></code></pre></div>
<p>The transmission rate lambda has been calibrated to the incidence and import proportion and it can be used to simulate future scenarios. The quantity <span class="math inline">\(\delta\)</span> (called “delta”) representing the daily importation rate was also calculated based on the observed data.</p>
</div>
<div id="simulate-a-future-scenario-with-the-fitted-model-" class="section level3">
<h3 class="hasAnchor">
<a href="#simulate-a-future-scenario-with-the-fitted-model-" class="anchor"></a>Simulate a future scenario with the fitted model.</h3>
<p>In this section, we will see how to use the calibrated model to simulate the impact of a future intervention.</p>
<p>As a first step, the intervention variables describing the new intervention scenario need to be defined. For each intervention, we create an intervention object containing new parameter values after the intervention. For example, we want to increase the proportion of radical cure <span class="math inline">\(\beta\)</span> from 0.4 to 0.6 (intervention A) or 0.8 (intervention B).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">intervention_object0</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>intervention_name<span class="op">=</span><span class="st">"baseline"</span>, <span class="st">"alpha.new"</span><span class="op">=</span><span class="cn">NA</span>, <span class="st">"beta.new"</span><span class="op">=</span><span class="cn">NA</span>, <span class="st">"omega.new"</span><span class="op">=</span><span class="cn">NA</span> <span class="op">)</span>
<span class="va">intervention_objectA</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>intervention_name<span class="op">=</span><span class="st">"intervA"</span>, <span class="st">"alpha.new"</span><span class="op">=</span><span class="cn">NA</span>, <span class="st">"beta.new"</span><span class="op">=</span><span class="fl">0.6</span>, <span class="st">"omega.new"</span><span class="op">=</span><span class="cn">NA</span> <span class="op">)</span>
<span class="va">intervention_objectB</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>intervention_name<span class="op">=</span><span class="st">"intervB"</span>, <span class="st">"alpha.new"</span><span class="op">=</span><span class="cn">NA</span>, <span class="st">"beta.new"</span><span class="op">=</span><span class="fl">0.8</span>, <span class="st">"omega.new"</span><span class="op">=</span><span class="cn">NA</span> <span class="op">)</span></code></pre></div>
<p>Now, we use the previously calibrated model (using the values contained in mydata_withR0RC) to simulate the interventions. Make sure that the data frame contains a variable called “id” that identifies uniquely each row.</p>
<p>Now, we simulate the model with the new parameterisation.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_intervention_list</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">intervention_object0</span>, <span class="va">intervention_objectA</span>, <span class="va">intervention_objectB</span><span class="op">)</span>
<span class="va">simulation_model</span><span class="op">=</span> <span class="fu"><a href="../reference/simulate_vivax_interventions.html">simulate_vivax_interventions</a></span><span class="op">(</span>df<span class="op">=</span><span class="va">mydata_withR0RC</span>, <span class="va">my_intervention_list</span><span class="op">)</span>
<span class="va">simulation_model</span>
<span class="co">#&gt;         id time          Il          I0          Sl        S0          h</span>
<span class="co">#&gt; 1  regionA    0 0.013764538 0.003669252 0.014212164 0.9683540 0.02300000</span>
<span class="co">#&gt; 2  regionA  365 0.013764538 0.003669252 0.014212164 0.9683540 0.02300000</span>
<span class="co">#&gt; 3  regionA  730 0.013764538 0.003669252 0.014212164 0.9683540 0.02300000</span>
<span class="co">#&gt; 4  regionA 1095 0.013764538 0.003669252 0.014212164 0.9683540 0.02300000</span>
<span class="co">#&gt; 5  regionA 1460 0.013764538 0.003669252 0.014212164 0.9683540 0.02300000</span>
<span class="co">#&gt; 6  regionA 1825 0.013764538 0.003669252 0.014212164 0.9683540 0.02300000</span>
<span class="co">#&gt; 7  regionA    0 0.013764538 0.003669252 0.014212164 0.9683540 0.02300000</span>
<span class="co">#&gt; 8  regionA  365 0.012603849 0.003414580 0.012685001 0.9712966 0.02183618</span>
<span class="co">#&gt; 9  regionA  730 0.011493562 0.003114235 0.011568915 0.9738233 0.01987509</span>
<span class="co">#&gt; 10 regionA 1095 0.010522276 0.002851229 0.010592452 0.9760340 0.01817226</span>
<span class="co">#&gt; 11 regionA 1460 0.009666298 0.002619419 0.009731729 0.9779826 0.01667521</span>
<span class="co">#&gt; 12 regionA 1825 0.008907026 0.002413779 0.008968105 0.9797111 0.01535012</span>
<span class="co">#&gt; 13 regionA    0 0.013764538 0.003669252 0.014212164 0.9683540 0.02300000</span>
<span class="co">#&gt; 14 regionA  365 0.011371887 0.003140440 0.011097627 0.9743900 0.02056951</span>
<span class="co">#&gt; 15 regionA  730 0.009302327 0.002569787 0.009079595 0.9790483 0.01676249</span>
<span class="co">#&gt; 16 regionA 1095 0.007661822 0.002116858 0.007479603 0.9827417 0.01377586</span>
<span class="co">#&gt; 17 regionA 1460 0.006345263 0.001753285 0.006195175 0.9857063 0.01138855</span>
<span class="co">#&gt; 18 regionA 1825 0.005278180 0.001458553 0.005153884 0.9881094 0.00945982</span>
<span class="co">#&gt; 19 regionB    0 0.099644353 0.024983677 0.093153122 0.7822188 0.11200000</span>
<span class="co">#&gt; 20 regionB  365 0.099644353 0.024983677 0.093153122 0.7822188 0.11200000</span>
<span class="co">#&gt; 21 regionB  730 0.099644353 0.024983677 0.093153122 0.7822188 0.11200000</span>
<span class="co">#&gt; 22 regionB 1095 0.099644353 0.024983677 0.093153122 0.7822188 0.11200000</span>
<span class="co">#&gt; 23 regionB 1460 0.099644353 0.024983677 0.093153122 0.7822188 0.11200000</span>
<span class="co">#&gt; 24 regionB 1825 0.099644353 0.024983677 0.093153122 0.7822188 0.11200000</span>
<span class="co">#&gt; 25 regionB    0 0.099644353 0.024983677 0.093153122 0.7822188 0.11200000</span>
<span class="co">#&gt; 26 regionB  365 0.095297313 0.024077122 0.087181388 0.7934442 0.10881593</span>
<span class="co">#&gt; 27 regionB  730 0.093234727 0.023510108 0.085158166 0.7980970 0.10553956</span>
<span class="co">#&gt; 28 regionB 1095 0.092367128 0.023271201 0.084307126 0.8000545 0.10418441</span>
<span class="co">#&gt; 29 regionB 1460 0.091999770 0.023170038 0.083946745 0.8008834 0.10361173</span>
<span class="co">#&gt; 30 regionB 1825 0.091843790 0.023127083 0.083793721 0.8012354 0.10336877</span>
<span class="co">#&gt; 31 regionB    0 0.099644353 0.024983677 0.093153122 0.7822188 0.11200000</span>
<span class="co">#&gt; 32 regionB  365 0.090720088 0.023114416 0.080960684 0.8052048 0.10542336</span>
<span class="co">#&gt; 33 regionB  730 0.086658544 0.021984267 0.077045231 0.8143120 0.09885379</span>
<span class="co">#&gt; 34 regionB 1095 0.084999725 0.021521791 0.075445874 0.8180326 0.09622890</span>
<span class="co">#&gt; 35 regionB 1460 0.084313667 0.021330495 0.074784306 0.8195715 0.09514726</span>
<span class="co">#&gt; 36 regionB 1825 0.084028453 0.021250965 0.074509256 0.8202113 0.09469828</span>
<span class="co">#&gt;             hr           I         p incidence intervention</span>
<span class="co">#&gt; 1  0.012968600 0.017433790 0.0000000  23.00000     baseline</span>
<span class="co">#&gt; 2  0.012968600 0.017433790 0.0000000  23.00000     baseline</span>
<span class="co">#&gt; 3  0.012968600 0.017433790 0.0000000  23.00000     baseline</span>
<span class="co">#&gt; 4  0.012968600 0.017433790 0.0000000  23.00000     baseline</span>
<span class="co">#&gt; 5  0.012968600 0.017433790 0.0000000  23.00000     baseline</span>
<span class="co">#&gt; 6  0.012968600 0.017433790 0.0000000  23.00000     baseline</span>
<span class="co">#&gt; 7  0.012968600 0.017433790 0.0000000  23.00000      intervA</span>
<span class="co">#&gt; 8  0.012172229 0.016018429 0.0000000  21.83618      intervA</span>
<span class="co">#&gt; 9  0.011054140 0.014607797 0.0000000  19.87509      intervA</span>
<span class="co">#&gt; 10 0.010101502 0.013373505 0.0000000  18.17226      intervA</span>
<span class="co">#&gt; 11 0.009264876 0.012285717 0.0000000  16.67521      intervA</span>
<span class="co">#&gt; 12 0.008525026 0.011320805 0.0000000  15.35012      intervA</span>
<span class="co">#&gt; 13 0.012968600 0.017433790 0.0000000  23.00000      intervB</span>
<span class="co">#&gt; 14 0.011309489 0.014512327 0.0000000  20.56951      intervB</span>
<span class="co">#&gt; 15 0.009169137 0.011872114 0.0000000  16.76249      intervB</span>
<span class="co">#&gt; 16 0.007527762 0.009778681 0.0000000  13.77586      intervB</span>
<span class="co">#&gt; 17 0.006218205 0.008098549 0.0000000  11.38855      intervB</span>
<span class="co">#&gt; 18 0.005161749 0.006736734 0.0000000   9.45982      intervB</span>
<span class="co">#&gt; 19 0.061390495 0.124628030 0.1000000 112.00000     baseline</span>
<span class="co">#&gt; 20 0.061390495 0.124628030 0.1000000 112.00000     baseline</span>
<span class="co">#&gt; 21 0.061390495 0.124628030 0.1000000 112.00000     baseline</span>
<span class="co">#&gt; 22 0.061390495 0.124628030 0.1000000 112.00000     baseline</span>
<span class="co">#&gt; 23 0.061390495 0.124628030 0.1000000 112.00000     baseline</span>
<span class="co">#&gt; 24 0.061390495 0.124628030 0.1000000 112.00000     baseline</span>
<span class="co">#&gt; 25 0.061390495 0.124628030 0.1000000 112.00000      intervA</span>
<span class="co">#&gt; 26 0.058902368 0.119374435 0.1035438 108.81593      intervA</span>
<span class="co">#&gt; 27 0.056692667 0.116744835 0.1070770 105.53956      intervA</span>
<span class="co">#&gt; 28 0.055801401 0.115638329 0.1086057 104.18441      intervA</span>
<span class="co">#&gt; 29 0.055425222 0.115169808 0.1092638 103.61173      intervA</span>
<span class="co">#&gt; 30 0.055265708 0.114970873 0.1095453 103.36877      intervA</span>
<span class="co">#&gt; 31 0.061390495 0.124628030 0.1000000 112.00000      intervB</span>
<span class="co">#&gt; 32 0.056261601 0.113834504 0.1075483 105.42336      intervB</span>
<span class="co">#&gt; 33 0.051873128 0.108642811 0.1153676  98.85379      intervB</span>
<span class="co">#&gt; 34 0.050171072 0.106521516 0.1187966  96.22890      intervB</span>
<span class="co">#&gt; 35 0.049471391 0.105644162 0.1202650  95.14726      intervB</span>
<span class="co">#&gt; 36 0.049181233 0.105279418 0.1208845  94.69828      intervB</span></code></pre></div>
<p>The variable “time” indicates the number of days since baseline. The other variables are the state variables of the model. The variable I indicates the proportion of all individuals with blood stage infection (<span class="math inline">\(I=I_L+I_0\)</span>), i.e. prevalence (including any parasite concentration). The variable incidence indicates the incidence per 1000 person year.</p>
<p>The model outputs can be represented graphically, for example using the ggplot2 package.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">simulation_model</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span><span class="op">/</span><span class="fl">365</span>,y<span class="op">=</span><span class="va">incidence</span>, color<span class="op">=</span><span class="va">intervention</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="va">id</span> <span class="op">~</span><span class="va">.</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Year since baseline"</span><span class="op">)</span></code></pre></div>
<p><img src="vivaxmodelr_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</div>
<div id="including-uncertainty-quantification-in-data-reporting" class="section level3">
<h3 class="hasAnchor">
<a href="#including-uncertainty-quantification-in-data-reporting" class="anchor"></a>Including uncertainty quantification in data reporting</h3>
<p>Creating a dummy dataset with reported numbers or total cases and local cases, i.e. as opposed to imported cases, and the population size of the area (the user should include their real data). Each line corresponds to an administrative area or a year of data. We also added the reporting and case management parameters for each setting.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mydata_2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"regionA"</span>,<span class="st">"regionB"</span><span class="op">)</span>,cases<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">114</span>,<span class="fl">312</span><span class="op">)</span>,cases_local<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">110</span>,<span class="fl">290</span><span class="op">)</span>, population<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10000</span>,<span class="fl">5000</span><span class="op">)</span><span class="op">)</span>
<span class="va">mydata_2</span><span class="op">$</span><span class="va">alpha</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.18</span>, <span class="fl">0.13</span><span class="op">)</span> <span class="co"># proportion of treated cases</span>
<span class="va">mydata_2</span><span class="op">$</span><span class="va">beta</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.43</span>,<span class="fl">0.42</span><span class="op">)</span> <span class="co"># proportion of radical cure</span>
<span class="va">mydata_2</span><span class="op">$</span><span class="va">rho</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.17</span>, <span class="fl">0.12</span><span class="op">)</span> <span class="co"># reporting rate (here, we assume that all treated cases are reported)</span>
<span class="va">mydata_2</span><span class="op">$</span><span class="va">omega</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>  <span class="co"># no vector control</span></code></pre></div>
<p>Draw 100 samples of the incidence and proportion of imported cases, given the observed total and local number of cases. The uncertainty modelled here is due to population size: for additional information concerning the model, please refer to the associated publication.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mydata_2u</span><span class="op">=</span><span class="fu"><a href="../reference/sample_uncertainty_incidence_import.html">sample_uncertainty_incidence_import</a></span><span class="op">(</span><span class="va">mydata_2</span>, ndraw <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>
<p>Run the model and save the results in a new database.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mydata_withR0RC_u</span><span class="op">=</span><span class="fu"><a href="../reference/calculate_r0_rc_fromdata.html">calculate_r0_rc_fromdata</a></span><span class="op">(</span>df<span class="op">=</span><span class="va">mydata_2u</span>, f<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">72</span>, gamma<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">223</span>, r<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">60</span>, return.all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span>

<span class="co">#&gt; Warning in solve_lambda_vivax(h = my.h, r = r, gamma = gamma, f = f, alpha =</span>
<span class="co">#&gt; my.alpha, : imaginary parts discarded in coercion</span></code></pre></div>
<p>This database includes 100 replicates of the <span class="math inline">\(R_0\)</span> and <span class="math inline">\(R_c\)</span> calculation, including the sampling uncertainty in the incidence and proportion of imported cases.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">mydata_withR0RC_u</span><span class="op">)</span>
<span class="co">#&gt; [1] 200</span></code></pre></div>
</div>
<div id="limitations-of-the-model" class="section level3">
<h3 class="hasAnchor">
<a href="#limitations-of-the-model" class="anchor"></a>Limitations of the model</h3>
<p>The model is a simplified representation of reality, and has therefore some limitations.</p>
<p>Firstly, the model does not include any form of immunity. This simplifcation is acceptable for settings with low to moderate transmission intensity. For high transmission settings (roughly observed annual incidence &gt; 200), other models should be used instead.</p>
<p>Secondly, the model is deterministic and therefore neglects the randomness in very small populations. For very low transmission settings (&lt; 20 reported cases annually), other models should be used instead.</p>
<p>Finally, in some instances, the models cannot provide <span class="math inline">\(R_0\)</span> and <span class="math inline">\(R_c\)</span> estimates (NA values, and lambda=-2). This means that the combination of incidence, importation and parameter values does not correspond to any mathematical solution. In this case, please revise the assumptions used.</p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-galactionova2015" class="csl-entry">
Galactionova, Katya, Fabrizio Tediosi, Don de Savigny, Thomas Smith, and Marcel Tanner. 2015. <span>“Effective Coverage and Systems Effectiveness for Malaria Case Management in Sub-Saharan African Countries.”</span> Edited by Georges Snounou. <em>PLOS ONE</em> 10 (5): e0127818. <a href="https://doi.org/10.1371/journal.pone.0127818">https://doi.org/10.1371/journal.pone.0127818</a>.
</div>
<div id="ref-white2016" class="csl-entry">
White, Michael T., George Shirreff, Stephan Karl, Azra C. Ghani, and Ivo Mueller. 2016. <span>“Variation in Relapse Frequency and the Transmission Potential of Plasmodium Vivax Malaria.”</span> <em>Proceedings of the Royal Society B: Biological Sciences</em> 283 (1827): 20160048. <a href="https://doi.org/10.1098/rspb.2016.0048">https://doi.org/10.1098/rspb.2016.0048</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Clara Champagne, Emilie Pothin, Maximilian Gerhards.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
